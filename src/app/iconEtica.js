'use client'
import { useRef } from 'react';
import { useEffect } from 'react';
import { useState } from 'react';

export default function IconEtica({ progress }) {

    const svgRef = useRef(null); // Riferimento per il SVG
    const [isMounted, setIsMounted] = useState(false); // Stato per controllare se il componente Ã¨ montato

    useEffect(() => {
        setIsMounted(true);
      }, []);

    // Aggiorna le dimensioni del rect in base al progresso
    useEffect(() => {
        if (svgRef.current) {
            const svgElement = svgRef.current; // Accesso all'elemento SVG
            const bilancia = svgElement.getElementById('bilancia');
            const bbox = bilancia.getBBox(); // Ottieni le dimensioni di <g>

            const rect = svgElement.getElementById('clip-rect');
            rect.setAttribute('width', bbox.width);
            rect.setAttribute('x', bbox.x);
            rect.setAttribute('height', (progress / 100) * bbox.height);
            rect.setAttribute('y', bbox.y + bbox.height - (progress / 100) * bbox.height);
        }
    }, [progress]); // Questa useEffect dipende da progress

    return (
        <div className='w-full h-10  '>
            <svg ref={svgRef} xmlns="http://www.w3.org/2000/svg" viewBox="0 0 180 180 ">
                <defs>
                    <clipPath id='etica'>
                        <rect className={isMounted ? 'transition-all ease-out duration-300' : ''} id="clip-rect" width={0} height={0} x={0} y={0} />
                    </clipPath>
                </defs>
                <g fill='#f4ead7' >
                    <path id='bilancia' d="M178.352540892,101.5345122192h-3.0400002906l-12.1848080247-21.1148246348-.0991266079-.1652152149-13.0935106143-23.9565717095c-.3882626878-.7434747696-1.0656614556-1.3134779754-1.9247755311-1.5447817973l-44.2453076647-11.8543775949c-.1734715639-4.617832694-2.7508642107-8.6243678322-6.5178517833-10.8052414423v-11.2430674341c0-1.7017406632-3.3374053246-3.3704433255-6.5343644812-3.3704433255s-6.840013259,1.3795665824-6.840013259,3.0730508967v11.7139314268c-1.7100096173,1.0491361526-3.1556648067,2.4782660389-4.2295700061,4.1717503532l-44.6583520045-11.9700295058c-1.4126171884-.3800063389-2.8582723778.2973924289-3.5026205395,1.5530507514L6.0965384894,71.2500981984h-3.0234875927c-1.7017406632,0-3.0730508967,1.3713102334-3.0730508967,3.0647945477,0,9.4422001629,3.8247946204,18.0004667831,10.0204597177,24.1796191825,6.1791397943,6.1956650973,14.7374190195,10.0287160666,24.1713502284,10.0287160666s18.0004667831-3.8413073183,24.1878755314-10.0287160666c6.1956650973-6.1791397943,10.0204597177-14.7374190195,10.0204597177-24.1796191825,0-1.6934843143-1.3713102334-3.0647945477-3.0730508967-3.0647945477h-3.0317439417l-12.1848080247-21.0983119368-.090870259-.1817405179-9.4752381639-15.976552039,37.0996456278,9.9295894587c.1652152149,4.5104497371,2.6186996018,8.4343709654,6.2287030982,10.6482825763v110.4563355059l-25.9474484527.1156645161c-.198265821,0-.3882626878.0165126979-.5700032058.057832258h-1.7100096173c-4.3782725231,0-7.9221874125,3.5521712384-7.9221874125,7.9221874125v.3717499899c0,4.378259918,3.5439148894,7.9221874125,7.9221874125,7.9221874125h70.0357972514c4.378259918,0,7.9221874125-3.5439274945,7.9221874125-7.9221874125v-.3717499899c0-4.3700161742-3.5439274945-7.9221874125-7.9221874125-7.9221874125h-1.6273957073c-.1817405179-.0412943499-.3717499899-.057832258-.5700032058-.057832258l-26.2365845326-.1156645161V54.7448625138c1.8339178772-1.0656488505,3.3869686286-2.5608799489,4.518706086-4.3452219171l40.8087757321,10.9208933532-11.168709873,18.9339510247s-9.4008932079,16.3069950739-12.2839346326,21.2800398497h-3.0400002906c-1.6852279653,0-3.0647819426,1.3795665824-3.0647819426,3.0647945477,0,9.4504565119,3.8330635744,18.0004793882,10.0121907636,24.1878755314,6.1956650973,6.1791523994,14.7539317174,10.0121907636,24.1878755314,10.0121907636s17.9922104341-3.8330635744,24.1878755314-10.0121907636c6.1791523994-6.1956650973,10.0121907636-14.7374190195,10.0121907636-24.1878755314,0-1.6852153602-1.3795791875-3.0647945477-3.0647819426-3.0647945477v-.0000126051ZM44.7161842625,53.0431092454l.0991266079.1569588659,10.4169787545,18.0500426922H13.1678555703l21.0239543758-36.4387721631,10.5243743164,18.2317832101v-.0000126051ZM126.1767768608,101.5345122192l10.5161179675-18.2152579071,10.5243617113-18.2152579071,10.5243617113,18.223514256.0991266079.1569588659,10.4169661493,18.0500426922h-42.0809593576.0000252102Z">
                    </path>
                </g>
                <use clipPath="url(#etica)" href="#bilancia" fill="#778c2a" />
            </svg>
        </div>
    )
}
